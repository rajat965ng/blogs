flowchart TD
    A[Host goes down] --> B[Loss of aggregated events]
    B --> C[Cascading failure]
    C --> D[Earlier hosts may overflow]
    D --> E[Aggregated events lost]
    A --> F[Use checkpointing and dead letter queues]
    F --> G[Processing repeated]
    G --> H[Waste of resources]
    G --> I[Considerable latency]
    A --> J[Convert each node into independent service]
    J --> K[Cluster of stateless nodes]
    K --> L[Requests to shared in-memory database]
    L --> M[Each service has multiple hosts]
    M --> N[Shared load balancing service]
    N --> O[Spread requests across hosts]
    M --> P[Each service has separate Redis cluster]
    P --> Q[No competition for writing]
    Q --> R[Aggregated events deleted after flush]
    R --> S[Controlled database size]
